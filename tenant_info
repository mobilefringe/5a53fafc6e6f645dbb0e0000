<div class="inside_banner">   
    <div class="content_container">
        <div class="inside_banner_content">
            <div class="row">
                <div class="col-md-12">
                    <h1 id="mm_page_title"></h1>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="content_container margin_30 pages_container">
    <div class="margin_30"></div>
    <div>
        <h2 id="page_title"></h2>
    </div>
    <div class="col-sm-12">
       <p>
            This manual is intended to aid you in the day-to-day operations of your store and to hopefully answer any and all questions you may have regarding your tenancy at St. Vital Centre. Should you have any questions or concerns, please feel free to contact the Administration Office at any time and we will be pleased to assist you.
        </p>
        <p>
            It is suggested all new employees familiarize themselves with the contents of this manual, and that it be kept in a convenient location (at the cash register or store bulletin board) for easy reference as required.
        </p>
        <p>
            This manual is intended as a guideline, and in cases where there is a discrepancy between the manual and your lease, the provisions of the lease shall prevail.
        </p>
        <p>
            Click <a style="text-decoration:underline;" href="https://www.mallmaverick.com/system/site_images/photos/000/001/898/original/Tenant_Manual_-revised_October_2012.pdf?1394039465" target="_blank">here</a> for a pdf copy of the Tenant Manual.
        </p>
    </div>
    <div>
        <div class="row-fluid tenant_select store_list_padding " >
                <div class="col-sm-4">
                    <label>Category</label>
                    <span class="selector-wrap" id="category_select">
                        <!--<span class="select_name">Pick a Category</span>-->
                        <select id="menual_select">
                            <option value="" disabled selected>Pick a Category</option>
                            <option value="all">View All</option>
                            <option value="0">Heating, Ventilation and Air Conditioning (HVAC)</option>
                            <option value="1">Restaurant and Food Hall Tenants</option>
                            <option value="2">Maintenance</option>
                            <option value="3">Garbage Disposal and Recycling</option>
                            <option value="4">Deliveries</option>
                            <option value="5">Employee Parking</option>
                            <option value="6">Store Mechandising Guidelines</option>
                            <option value="7">Emergency Information and Procedures</option>
                            <option value="8">Security</option>
                            <option value="9">Gift Card Procedures</option>
                            <option value="10">Customer Service</option>
                            <option value="11">Marketing Department</option>
                            <option value="12">Hours of Business</option>
                            <option value="13">St. Vital Centre Administration</option>
                            <option value="14">St. Vital Centre Profile</option>
                        </select>
                        <span class="select_icon"></span>
                    </span>
                </div>
                <div class="col-sm-4">
                    <label>Shoptalk</label>
                    <span class="selector-wrap" id="brand_select">
                        <!--<span class="select_name">Find an Issue</span>-->
                        <select id="issue_select">
                            <script id="issue_select_template" type="x-tmpl-mustache/text">
                                <option value="image_url">
                                    {{show_name}}                                            
                                </option>    
                            </script>
                        </select>
                        <span class="select_icon"></span>
                    </span>
                </div>
                <div class="col-sm-4">  
                    <label>Memo</label>
                    <span class="selector-wrap" id="service_select">
                        <!--<span class="select_name">Pick a Memo</span>-->
                        <select id="memo_select">
                            <script id="memo_select_template" type="x-tmpl-mustache/text">
                            <option value="image_url">
                                {{show_name}}                                            
                            </option>    
                        </script>
                        </select>
                        <span class="select_icon"></span>
                    </span>
                </div>
            </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <div class="manual_list">
                <h3 class="manual_title">
                    list all                
                </h3>
                <div class="store_list_padding">
                    
                </div>
            </div>
        
            <div class="unit_info manual_info">
                {{page.body}}
                <p class="back">
                    <a href="/pages/svc-tenants-manual"><img src="{{1846 | get_image_url}}">List all</a>
                </p>
            </div>
            <div id="mm_page_content"></div>
        </div>
    </div>
</div>
<script>
    $(document).ready(function(e){
        init(e);
        function renderAll(){
            // var pathArray = window.location.pathname.split( '/' );
            // var slug = pathArray[pathArray.length-1];
            prefix = get_prefix();
            var pages_json = prefix + "/pages/svc-tenants-manual.json"
            $.getJSON(pages_json).done(function(data) {
                $('#mm_page_title').html(data.title.toUpperCase());
                $('#mm_page_content').html(data.body);
            }).fail(function(jqXHR) {
                if (jqXHR.status == 404) {
                    $("#404_msg").fadeIn("fast");
                }
            }); 
            
            // if(slug == "svc-tenant-login") {
            //     $("#tenant_login").show();
            //     $('#page_title').text("Login");
            // }
            
            if ($.cookie("tenant_login") !== "true"){
                console.log("tenant is logged in")
                window.location.href = "/tenant_login";        
            }
            else {
                $(".unit_info h2").each(function(){
                        var title = $(this).text();
                        $(this).html("<strong>"+title+"</strong> <span>read more</span>");                                
                        $("<p class='readless'>read less</p>").insertBefore( $(this) );
                    })
                    $(".readless").first().remove();
                    $(".unit_info h2").click(function(){
                        $(this).nextUntil( "h2" ).show();
                    })
                    
                    $(".readless").on("click",function(){
                        $(this).hide();
                        $(this).prevUntil( "h2" ).hide();
                    })
                    
                    $(".unit_info").show();
                    $(".unit_info ul, .unit_info p, .unit_info h3, .unit_info h2").hide();            
                    
                    $(".manual_info h3").each(function(index){
                        $(this).addClass("manual"+index);
                        var js = "javascript:show_manual("+index+")";
                        $(".manual_list .store_list_padding").append("- <a href='?show="+index+"'>"+$(this).text()+"</a><br/>")
                        $(this).nextUntil("h3", "h2").each(function(){
                            $(".manual_list .store_list_padding").append("<span>- "+$(this).find("strong").text()+"</span><br/>")
                        })
                    })
                    
                    $(".expend_all").click(function(){
                        $(this).nextUntil("h3").show();
                    })
                    
                    if (getURLParameter("show") != "null"){
                        show_manual(getURLParameter("show"));
                    } else {                        
                        $(".manual_list .store_list_padding").show();
                    }
            }
    //         $('#tenant_login_form').submit(function(e) {
    //             // values = [];
    //             // values = JSON.stringify($('#tenant_login_form').serializeArray());
    //             e.preventDefault();
    //             var data = {}
    //               data["username"] = $("#username").val();
    //               data["pin"] = $("#pin").val();
    //               if ($("#username").val() !="" && $("#pin").val() != ""){
    //                   $.ajax({
    //                         url: prefix + "/verify_pin",
    //                         type: "POST",
    //                         data: data,
    //                         success: function(response){
    //                             if (response["msg"] == "success"){
    //                                 $("#tenant_login").hide();
    //                                 $("#tenant_select").show();
    //                                 // $(".flexslider").remove();
    //                                 // $(".login_title").remove();
    //                                 $('#page_title').text("Welcome");
    //                                 window.scrollTo(0,0);
    //                                 var date = new Date();
    //                                 var minutes = 15;
    //                                 date.setTime(date.getTime() + (minutes * 60 * 1000));                                
    //                                 $.cookie("tenant_login", "true", { expires: date });                                
    //                             } else {
    //                                 alert("Please try again later.");
    //                     	    }
    //             			},
    //                         error: function(xhr, ajaxOptions, thrownError){
    //                             alert("Please try again later.");
    //             			}
    //                     }) 
    //               }
    //               else{
    //                   alert("Please provide username and password.");
    //               }
    // 		});
    		
    		//populating tenant select div
            // <option value="">Find an Issue</option>
            // <option value="/pages/svc-tenants-shoptalk">Vew All</option>
            
            
    		var shop_talks = getRepoDetailsByName("Shoptalk").images;
    		$.each(shop_talks, function(key, val){
    		    val.show_name = val.name.split(".")[1];
    		})
            renderGeneral("#issue_select", "#issue_select_template", shop_talks);
            
            var memos = getRepoDetailsByName("Memo").images;
            $.each(memos, function(key, val){
    		    val.show_name = val.name.split(".")[1];
    		})
            renderGeneral("#memo_select", "#memo_select_template", memos);
            $('#issue_select').prepend('<option value="/pages/svc-tenants-shoptalk" selected="selected">View All</option>');
    		$('#issue_select').prepend('<option value="" selected="selected" disabled>Find an Issue</option>');
            
            $('#memo_select').prepend('<option value="/pages/svc-tenants-memo" selected="selected">View All</option>');
            $('#memo_select').prepend('<option value="" selected="selected" disabled>Pick an Memo</option>');
            
            $("#menual_select").change(function(){
                if ($(this).val() == "" ){
                    window.location.href = "/tenant_info";            
                } else {
                    window.location.href = "/tenant_info?show="+$(this).val();            
                }
            });
        
            show_content();
        }
        loadMallDataCached(renderAll); 
    });
    function getURLParameter (val) {
        // console.log(val);
        // console.log(window.location);
        var new_val = window.location.search.split(val+"=")[1];
        console.log(new_val);
    }
    function show_manual(id){
                if(id == "all"){
                    $(".manual_list .store_list_padding").show();
                } else if (id != "all" || id != "" ){                    
                    var name = "manual"+id;
                    $(".manual_list .store_list_padding").hide();
                    var expend_js = "javascript:expend_all("+id+")";                    
                    $(".manual_list .manual_title").html($("."+name).text() + "<a class='expend_all' href="+expend_js+">expand all</a>");
                    $("."+name).nextUntil("h3", "h2").show()
                    $(".back").show();
                }
            }
            
            function expend_all(id){
                $(".manual"+id).nextUntil("h3").show();
            }
</script>